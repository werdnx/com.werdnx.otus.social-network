# Общие (дефолтные) настройки, всегда загружаются
spring:
  profiles:
    default: single
  jpa:
    hibernate:
      ddl-auto: none
  liquibase:
    change-log: classpath:/db/changelog/db.changelog-master.xml
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=10000, expireAfterWrite=5m
  rabbitmq:
    host: ${SPRING_RABBITMQ_HOST:localhost}
    port: ${SPRING_RABBITMQ_PORT:5672}
    username: ${SPRING_RABBITMQ_USERNAME:app}
    password: ${SPRING_RABBITMQ_PASSWORD:app}
    publisher-confirm-type: correlated
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      timeout: 2000
app:
  feed:
    fanout-chunk-size: 500

server:
  port: 8080

security:
  user:
    name: dummy     # later disable the default user
    password: dummy

jwt:
  secret: verySecretKeyReallySecretISwearYou
  access-token-validity-seconds: 900    # 15 minutes
  refresh-token-validity-seconds: 604800  # 7 days

#Single DB
---
spring:
  config:
    activate:
      on-profile: single
  datasource:
    master:
      url: jdbc:postgresql://localhost:5432/socialdb
      username: socialuser
      password: socialpass
    slave:
      url: jdbc:postgresql://localhost:5432/socialdb
      username: socialuser
      password: socialpass

#Replication streaming or sync
---
spring:
  config:
    activate:
      on-profile: multi
  datasource:
    master:
      url: jdbc:postgresql://postgres-master:5432/social_network_rep
      username: otus
      password: otus_pass
      driver-class-name: org.postgresql.Driver
    slave:
      url: >-
        jdbc:postgresql://postgres-slave1:5432,postgres-slave2:5432/social_network_rep
        ?targetServerType=slave&loadBalanceHosts=true
      username: otus
      password: otus_pass
      driver-class-name: org.postgresql.Driver

